#+title:   Bits
#+startup: content

Platforms control your audience. Payment processors control your revenue. Bits
gives you both back.

*What you get:*

- Subscriptions, one-time purchases, digital downloads
- Video hosting and delivery
- Your data, your domain, your rules
- Permissive content policies for persecuted creators

*Why it works:*

- Self-host on a $5/month VPS or use managed hosting
- Single binary deployment - no complex setup
- Built with care to minimize resource usage and maximize reliability
- Open source - audit the code, modify what you need, contribute back

*The model:* Like WordPress.org - free to self-host, managed option available.
You're never locked in.

*Current state:* Active development. Your funding accelerates delivery.

* Development
Start required services and spawn a Tailwind watcher via =devenv=:

#+begin_src sh :eval never
devenv up
#+end_src

Then one can start an hot-reloading development process via Dioxus like so:

#+begin_src sh :eval never
just serve
#+end_src

** Dioxus version
One needs to ensure Dioxus and =dioxus-cli= remain in sync or one might
encounter errors inside of =link= tags:

#+begin_src html :eval never
<link rel="stylesheet" href="/assets/This should be replaced by dx as part of the build process. If you see this error, make sure you are using a matching version of dx and dioxus and you are not stripping symbols from your binary."></link>
#+end_src

#+begin_src sh :results output table :colnames '("Package" "Version") :exports results
echo -e "dioxus\t$(grep 'dioxus = ' Cargo.toml | grep -o '[0-9]\+\.[0-9]\+\.[0-9]\+')"
echo -e "dioxus-cli\t$(grep 'version = ' nix/overlays/dioxus-cli.nix | grep -o '[0-9]\+\.[0-9]\+\.[0-9]\+')"
echo -e "wasm-bindgen-cli\t$(grep 'version = ' nix/overlays/wasm-bindgen-cli.nix | grep -o '[0-9]\+\.[0-9]\+\.[0-9]\+')"
#+end_src

#+results:
| Package          | Version |
|------------------+---------|
| dioxus           |   0.7.1 |
| dioxus-cli       |   0.7.1 |
| wasm-bindgen-cli | 0.2.105 |

** HTTPS and =*.test= URLs
*** Setup
To get our =*.test= URLs to work takes some effort with DNS.

#+begin_src sh :results output table :colnames '("Host" "Address")
drill bits.test | awk '/^bits/ { print $1 "\t" $5 }'
#+end_src

#+results:
| Host       |   Address |
|------------+-----------|
| bits.test. | 127.0.0.1 |

#+begin_src sh :results output verbatim
cat /etc/resolver/test
#+end_src

#+results:
: nameserver 10.10.10.254

*** Test
#+begin_src sh :results output verbatim :shebang "#!/usr/bin/env zsh"
urls=(
  https://www.usebits.app.test
  https://bits.page.test
  https://jcf.bits.page.test
)

for url in $urls; do
  http_code="$(curl --silent --output /dev/null --write-out "%{http_code}" "$url")"
  if [ "$http_code" -eq 200 ]; then
    echo "✅ $url"
  else
    echo "❌ $url ($http_code)"
  fi
done
#+end_src

#+results:
: ✅ https://www.usebits.app.test
: ✅ https://bits.page.test
: ✅ https://jcf.bits.page.test

** Decision records
#+begin_src sh :results output raw :exports output :exports results
fd --type file '\.org$' decisions | while read -r file; do
  title=$(awk -F':[[:space:]]*' 'NR==1 { print $2 }' "$file")
  echo "- [[file:$file][$title]]"
done
#+end_src

#+results:
- [[file:decisions/20251009133634-get-the-message-out.org][Get the message out]]
- [[file:decisions/20251009144920-python-style-environment-variables.org][Python-style environment variables]]
- [[file:decisions/20251118100535-mission-over-saas-startup-playbook.org][Mission over SaaS startup playbook]]

** Dev tasks
#+begin_src sh :results output verbatim :exports results
just
#+end_src

#+results:
#+begin_example
Available recipes:
    [dev]
    fmt              # Format project files
    mkcert           # Create self-signed SSL certificates via mkcert
    serve            # Run Dioxus
    setup            # Setup a local development environment
    tailwind         # Watch source code for Tailwind classes
    test             # Run tests
    www              # Run the marketing site

    [docs]
    decide +title    # Create a new decision record

    [iac]
    apply dir        # Apply one or all Terraform projects
    init dir *args   # Initialize one or all Terraform projects
    output dir *args # Interact with outputs one or all Terraform projects
    plan dir         # Plan one or all Terraform projects

    [postgres]
    migrate          # Run database migrations
    migration name   # Create a new migration
    psql             # Start an interactive psql session connected to the local development database
#+end_example

** SLOC
#+begin_src sh :results output verbatim :exports results
tokei
echo
echo "$(git describe --always --dirty --abbrev=7) @ $(date +"%Y/%m/%d %H:%M")"
#+end_src

#+results:
#+begin_example
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 Language              Files        Lines         Code     Comments       Blanks
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 Astro                    10          165          139            0           26
 CSS                       2            7            7            0            0
 HCL                      12          389          323           13           53
 HTML                      1           11           11            0            0
 JavaScript                2           42           34            1            7
 JSON                      4           56           56            0            0
 Just                      1          160           88           42           30
 MDX                       1           56            0           39           17
 Nix                       3          289          236            9           44
 Org                       6          625          510            4          111
 SQL                       1            8            5            2            1
 TOML                      5           94           80            0           14
 TypeScript                3           36           30            1            5
 YAML                      3         4949         3876            0         1073
─────────────────────────────────────────────────────────────────────────────────
 Rust                      5          366          306            5           55
 |- Markdown               5           16            0           16            0
 (Total)                              382          306           21           55
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 Total                    59         7269         5701          132         1436
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

f06f0c6-dirty @ 2025/11/19 21:36
#+end_example
